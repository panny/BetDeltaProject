#!/usr/bin/python3
# -*- coding: utf-8 -*-
import re
import furl
import copy
import json


class Config:
    redis_client = None
    session = None

    @staticmethod
    def is_json(text: str):
        if not text:
            return False
        try:
            json.loads(text.strip())
            return True
        except Exception:
            return False

    @staticmethod
    def get_redis_client():
        from utils.redisclient import RedisClient
        if not Config.redis_client:
            Config.redis_client = RedisClient(db=1)
        return Config.redis_client

    @staticmethod
    def get_key(string, params):
        for key, val in params.items():
            if key in string:
                return val

    @staticmethod
    def edit_dict(single, data):
        for key, val in single.items():
            if key in data:
                if isinstance(data[key], list):
                    if not isinstance(val, list):
                        val = [val]
                    data[key].extend(val)
                elif isinstance(data[key], dict):
                    data[key].update(val)
            else:
                data = val
        return data

    @staticmethod
    def get_re_url(href):
        from utils.settings import HREF_RE
        for key, val in HREF_RE.items():
            find = re.search(key, href)
            if find:
                iterate = re.finditer(key, href)
                params = {}
                for it in iterate:
                    params.update(it.groupdict())
                tmp = copy.deepcopy(val)
                url = tmp.get('url')
                if re.search(r"\{[a-z]+\}", url):
                    tmp['url'] = url.format(**params)
                else:
                    params = "&".join([f"{key}={val}" for key, val in params.items()])
                    tmp['url'] = f"{tmp.get('url')}?{params}"
                return tmp
        return {}

    @staticmethod
    def get_url_info(href):
        from utils.settings import HREF_RE
        url = furl.furl(href).url
        for val in HREF_RE.values():
            if url in val.get('url'):
                tmp = copy.deepcopy(val)
                tmp.pop('url')
                return tmp
        return {}

    @staticmethod
    def get_url_val(hrefs):
        from utils.settings import VAL_RE
        data = {}
        for href in hrefs:
            for k, v in VAL_RE.items():
                find = re.search(k, href)
                if find:
                    data[v] = find.group(1)
        return data

    @staticmethod
    def get_filter_dict(base, data, keys):
        """

        :param base:
        :param data:
        :param keys:
        :return:
        """
        tmp = []
        _data = {}
        for _dt in data:
            _k = "".join([_dt.get(x, '') if _dt.get(x, '') else '' for x in keys])
            _data[_k] = _dt
        for _dt in base:
            _k = "".join([_dt.get(x, '') if _dt.get(x, '') else '' for x in keys])
            if _k not in _data:
                tmp.append(_dt)
        return tmp

    @staticmethod
    def cmp_list(base: list = [], value: list = [], exact=True):
        """
        :param base:
        :param value:
        :param exact:
        :return:
        """
        for b in base:
            if b not in value:
                return False
        if exact:
            for v in value:
                if v not in base:
                    return False
        return True

    @staticmethod
    def cmp_dict(base: dict = {}, value: dict = {}, exact=True):
        """

        :param base:
        :param value:
        :param exact:
        :return:
        """
        if Config.cmp_list(list(base.keys()), list(value.keys()), exact):
            for k in base:
                if base.get(k) != value.get(k):
                    return False
            return True
        return False


if __name__ == '__main__':
    base =[{"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "768", "ranking": "04", "rank_date": "24/06/20", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"C\"", "route": "1200", "site_condition": "\u597d/\u5feb", "race_class": "2", "position": "2", "score": "89", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u6f58\u660e\u8f1d", "head_distance": "1", "single_win": "10", "actual_pound": "120", "blocking": "5 5 4", "finish_time": "1.09.29", "position_weight": "1138", "equipment": "B"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "745", "ranking": "06", "rank_date": "14/06/20", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u6fd5\u6162", "race_class": "2", "position": "7", "score": "90", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u8cc0\u9298\u5e74", "head_distance": "3", "single_win": "14", "actual_pound": "127", "blocking": "6 8 6", "finish_time": "1.08.36", "position_weight": "1145", "equipment": "B"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "591", "ranking": "06", "rank_date": "19/04/20", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "2", "position": "6", "score": "90", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u8cc0\u9298\u5e74", "head_distance": "6", "single_win": "9.6", "actual_pound": "127", "blocking": "8 7 6", "finish_time": "1.08.23", "position_weight": "1151", "equipment": "B"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "508", "ranking": "03", "rank_date": "18/03/20", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"C+3\"", "route": "1200", "site_condition": "\u597d", "race_class": "2", "position": "12", "score": "90", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u5229\u656c\u570b", "head_distance": "1-1/4", "single_win": "44", "actual_pound": "123", "blocking": "11 11 3", "finish_time": "1.09.28", "position_weight": "1145", "equipment": "B"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "434", "ranking": "03", "rank_date": "19/02/20", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "2", "position": "12", "score": "89", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u7530\u6cf0\u5b89", "head_distance": "1-1/4", "single_win": "12", "actual_pound": "119", "blocking": "7 6 3", "finish_time": "1.08.01", "position_weight": "1133", "equipment": "B"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "310", "ranking": "01", "rank_date": "05/01/20", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "8", "score": "82", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u8607\u5146\u8f1d", "head_distance": "1-1/4", "single_win": "21", "actual_pound": "131", "blocking": "8 7 1", "finish_time": "1.09.09", "position_weight": "1133", "equipment": "B"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "215", "ranking": "04", "rank_date": "01/12/19", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "2", "position": "10", "score": "82", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u8607\u5146\u8f1d", "head_distance": "2-1/4", "single_win": "9.2", "actual_pound": "115", "blocking": "7 6 4", "finish_time": "1.08.23", "position_weight": "1126", "equipment": "B"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "132", "ranking": "03", "rank_date": "27/10/19", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "9", "score": "80", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u5229\u656c\u570b", "head_distance": "\u9838\u4f4d", "single_win": "8.3", "actual_pound": "133", "blocking": "9 8 3", "finish_time": "1.09.22", "position_weight": "1139", "equipment": "B"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "089", "ranking": "01", "rank_date": "12/10/19", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "10", "score": "72", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u7530\u6cf0\u5b89", "head_distance": "2-1/2", "single_win": "12", "actual_pound": "125", "blocking": "4 4 1", "finish_time": "1.08.49", "position_weight": "1158", "equipment": "CP-/B1"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "796", "ranking": "05", "rank_date": "07/07/19", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "8", "score": "76", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u9673\u5609\u7199", "head_distance": "4", "single_win": "32", "actual_pound": "122", "blocking": "3 4 5", "finish_time": "1.09.54", "position_weight": "1144", "equipment": "CP1"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "737", "ranking": "09", "rank_date": "12/06/19", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u6fd5\u6162", "race_class": "3", "position": "11", "score": "78", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u675c\u7f8e\u723e", "head_distance": "4", "single_win": "45", "actual_pound": "133", "blocking": "9 9 9", "finish_time": "1.09.90", "position_weight": "1147", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "700", "ranking": "05", "rank_date": "29/05/19", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"C\"", "route": "1000", "site_condition": "\u597d", "race_class": "3", "position": "10", "score": "80", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u675c\u7f8e\u723e", "head_distance": "4", "single_win": "38", "actual_pound": "133", "blocking": "10 11 5", "finish_time": "0.57.65", "position_weight": "1145", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "646", "ranking": "07", "rank_date": "08/05/19", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u6fd5\u6162", "race_class": "3", "position": "6", "score": "80", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u9673\u5609\u7199", "head_distance": "5-1/4", "single_win": "5.2", "actual_pound": "123", "blocking": "4 6 7", "finish_time": "1.10.52", "position_weight": "1147", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "601", "ranking": "03", "rank_date": "22/04/19", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "8", "score": "79", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u6f58\u660e\u8f1d", "head_distance": "1-1/2", "single_win": "30", "actual_pound": "129", "blocking": "11 10 3", "finish_time": "1.08.69", "position_weight": "1153", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "550", "ranking": "06", "rank_date": "03/04/19", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "2", "score": "80", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u4f55\u6fa4\u582f", "head_distance": "6-1/4", "single_win": "5.7", "actual_pound": "131", "blocking": "7 6 6", "finish_time": "1.10.33", "position_weight": "1161", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "225", "ranking": "04", "rank_date": "02/12/18", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "2", "position": "5", "score": "81", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u5deb\u986f\u6771", "head_distance": "4-1/4", "single_win": "10", "actual_pound": "113", "blocking": "5 6 4", "finish_time": "1.08.41", "position_weight": "1147", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "144", "ranking": "09", "rank_date": "31/10/18", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "9", "score": "81", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u5deb\u986f\u6771", "head_distance": "5", "single_win": "5.6", "actual_pound": "124", "blocking": "1 1 9", "finish_time": "1.09.49", "position_weight": "1150", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "097", "ranking": "03", "rank_date": "13/10/18", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "11", "score": "80", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u5deb\u986f\u6771", "head_distance": "\u9838\u4f4d", "single_win": "7.6", "actual_pound": "128", "blocking": "2 2 3", "finish_time": "1.08.72", "position_weight": "1148", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "042", "ranking": "02", "rank_date": "22/09/18", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "7", "score": "78", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u5deb\u986f\u6771", "head_distance": "\u9838\u4f4d", "single_win": "2.4", "actual_pound": "126", "blocking": "2 2 2", "finish_time": "1.08.73", "position_weight": "1145", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "027", "ranking": "02", "rank_date": "09/09/18", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "3", "score": "76", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u7530\u6cf0\u5b89", "head_distance": "3/4", "single_win": "8", "actual_pound": "133", "blocking": "3 3 2", "finish_time": "1.09.45", "position_weight": "1145", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "785", "ranking": "01", "rank_date": "08/07/18", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u6fd5\u6162", "race_class": "3", "position": "3", "score": "70", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u7530\u6cf0\u5b89", "head_distance": "3/4", "single_win": "2.9", "actual_pound": "128", "blocking": "2 2 1", "finish_time": "1.08.38", "position_weight": "1133", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "731", "ranking": "04", "rank_date": "13/06/18", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"B\"", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "3", "score": "70", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u7530\u6cf0\u5b89", "head_distance": "2-1/4", "single_win": "5.6", "actual_pound": "126", "blocking": "3 2 4", "finish_time": "1.10.24", "position_weight": "1117", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "636", "ranking": "03", "rank_date": "09/05/18", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"A\"", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "3", "score": "70", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u7530\u6cf0\u5b89", "head_distance": "1", "single_win": "4.6", "actual_pound": "127", "blocking": "3 2 3", "finish_time": "1.10.55", "position_weight": "1143", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "583", "ranking": "01", "rank_date": "18/04/18", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"B\"", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "3", "score": "63", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u7530\u6cf0\u5b89", "head_distance": "1-1/4", "single_win": "4.3", "actual_pound": "117", "blocking": "4 3 1", "finish_time": "1.09.97", "position_weight": "1125", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "562", "ranking": "02", "rank_date": "11/04/18", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"A\"", "route": "1000", "site_condition": "\u597d", "race_class": "3", "position": "11", "score": "62", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u83ab\u96f7\u62c9", "head_distance": "1-3/4", "single_win": "3.7", "actual_pound": "115", "blocking": "2 2 2", "finish_time": "0.57.31", "position_weight": "1139", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "500", "ranking": "04", "rank_date": "14/03/18", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"B\"", "route": "1000", "site_condition": "\u597d", "race_class": "3", "position": "9", "score": "62", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u53f2\u5353\u8c50", "head_distance": "3/4", "single_win": "4.7", "actual_pound": "119", "blocking": "6 7 4", "finish_time": "0.57.50", "position_weight": "1144", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "425", "ranking": "06", "rank_date": "14/02/18", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"B\"", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "10", "score": "63", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u83ab\u96f7\u62c9", "head_distance": "4-1/4", "single_win": "5.3", "actual_pound": "116", "blocking": "1 1 6", "finish_time": "1.10.45", "position_weight": "1151", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "333", "ranking": "03", "rank_date": "10/01/18", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"B\"", "route": "1000", "site_condition": "\u597d", "race_class": "3", "position": "11", "score": "63", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u83ab\u96f7\u62c9", "head_distance": "1-1/4", "single_win": "4.2", "actual_pound": "117", "blocking": "5 5 3", "finish_time": "0.57.46", "position_weight": "1153", "equipment": "--"}, {"name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "241", "ranking": "12", "rank_date": "03/12/17", "track": "\u6c99\u7530\u8349\u5730\"C+3\"", "route": "1000", "site_condition": "\u597d", "race_class": "3", "position": "10", "score": "63", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u53f2\u5353\u8c50", "head_distance": "9", "single_win": "5.8", "actual_pound": "116", "blocking": "1 2 12", "finish_time": "0.57.49", "position_weight": "1160", "equipment": "--"}]
    val = [{"id": 16784, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "434", "ranking": "03", "rank_date": "19/02/20", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "2", "position": "12", "score": "89", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u7530\u6cf0\u5b89", "head_distance": "1-1/4", "single_win": "12", "actual_pound": "119", "blocking": "7 6 3", "finish_time": "1.08.01", "position_weight": "1133", "equipment": "B", "update_date": "2020-03-11T16:38:51.740", "create_date": "2020-03-11T16:38:51.740"}, {"id": 16786, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "310", "ranking": "01", "rank_date": "05/01/20", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "8", "score": "82", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u8607\u5146\u8f1d", "head_distance": "1-1/4", "single_win": "21", "actual_pound": "131", "blocking": "8 7 1", "finish_time": "1.09.09", "position_weight": "1133", "equipment": "B", "update_date": "2020-03-11T16:38:54.356", "create_date": "2020-03-11T16:38:54.355"}, {"id": 16788, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "215", "ranking": "04", "rank_date": "01/12/19", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "2", "position": "10", "score": "82", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u8607\u5146\u8f1d", "head_distance": "2-1/4", "single_win": "9.2", "actual_pound": "115", "blocking": "7 6 4", "finish_time": "1.08.23", "position_weight": "1126", "equipment": "B", "update_date": "2020-03-11T16:38:57.033", "create_date": "2020-03-11T16:38:57.033"}, {"id": 16790, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "132", "ranking": "03", "rank_date": "27/10/19", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "9", "score": "80", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u5229\u656c\u570b", "head_distance": "\u9838\u4f4d", "single_win": "8.3", "actual_pound": "133", "blocking": "9 8 3", "finish_time": "1.09.22", "position_weight": "1139", "equipment": "B", "update_date": "2020-03-11T16:38:59.499", "create_date": "2020-03-11T16:38:59.499"}, {"id": 16792, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "089", "ranking": "01", "rank_date": "12/10/19", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "10", "score": "72", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u7530\u6cf0\u5b89", "head_distance": "2-1/2", "single_win": "12", "actual_pound": "125", "blocking": "4 4 1", "finish_time": "1.08.49", "position_weight": "1158", "equipment": "CP-/B1", "update_date": "2020-03-11T16:39:01.975", "create_date": "2020-03-11T16:39:01.974"}, {"id": 16793, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "796", "ranking": "05", "rank_date": "07/07/19", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "8", "score": "76", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u9673\u5609\u7199", "head_distance": "4", "single_win": "32", "actual_pound": "122", "blocking": "3 4 5", "finish_time": "1.09.54", "position_weight": "1144", "equipment": "CP1", "update_date": "2020-03-11T16:39:04.498", "create_date": "2020-03-11T16:39:04.498"}, {"id": 16795, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "737", "ranking": "09", "rank_date": "12/06/19", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u6fd5\u6162", "race_class": "3", "position": "11", "score": "78", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u675c\u7f8e\u723e", "head_distance": "4", "single_win": "45", "actual_pound": "133", "blocking": "9 9 9", "finish_time": "1.09.90", "position_weight": "1147", "equipment": "--", "update_date": "2020-03-11T16:39:07.129", "create_date": "2020-03-11T16:39:07.129"}, {"id": 16797, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "700", "ranking": "05", "rank_date": "29/05/19", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"C\"", "route": "1000", "site_condition": "\u597d", "race_class": "3", "position": "10", "score": "80", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u675c\u7f8e\u723e", "head_distance": "4", "single_win": "38", "actual_pound": "133", "blocking": "10 11 5", "finish_time": "0.57.65", "position_weight": "1145", "equipment": "--", "update_date": "2020-03-11T16:39:09.592", "create_date": "2020-03-11T16:39:09.591"}, {"id": 16799, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "646", "ranking": "07", "rank_date": "08/05/19", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u6fd5\u6162", "race_class": "3", "position": "6", "score": "80", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u9673\u5609\u7199", "head_distance": "5-1/4", "single_win": "5.2", "actual_pound": "123", "blocking": "4 6 7", "finish_time": "1.10.52", "position_weight": "1147", "equipment": "--", "update_date": "2020-03-11T16:39:12.053", "create_date": "2020-03-11T16:39:12.053"}, {"id": 16801, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "601", "ranking": "03", "rank_date": "22/04/19", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "8", "score": "79", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u6f58\u660e\u8f1d", "head_distance": "1-1/2", "single_win": "30", "actual_pound": "129", "blocking": "11 10 3", "finish_time": "1.08.69", "position_weight": "1153", "equipment": "--", "update_date": "2020-03-11T16:39:14.506", "create_date": "2020-03-11T16:39:14.506"}, {"id": 16803, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "550", "ranking": "06", "rank_date": "03/04/19", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "2", "score": "80", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u4f55\u6fa4\u582f", "head_distance": "6-1/4", "single_win": "5.7", "actual_pound": "131", "blocking": "7 6 6", "finish_time": "1.10.33", "position_weight": "1161", "equipment": "--", "update_date": "2020-03-11T16:39:16.959", "create_date": "2020-03-11T16:39:16.959"}, {"id": 16805, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "225", "ranking": "04", "rank_date": "02/12/18", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "2", "position": "5", "score": "81", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u5deb\u986f\u6771", "head_distance": "4-1/4", "single_win": "10", "actual_pound": "113", "blocking": "5 6 4", "finish_time": "1.08.41", "position_weight": "1147", "equipment": "--", "update_date": "2020-03-11T16:39:19.412", "create_date": "2020-03-11T16:39:19.412"}, {"id": 16807, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "144", "ranking": "09", "rank_date": "31/10/18", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "9", "score": "81", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u5deb\u986f\u6771", "head_distance": "5", "single_win": "5.6", "actual_pound": "124", "blocking": "1 1 9", "finish_time": "1.09.49", "position_weight": "1150", "equipment": "--", "update_date": "2020-03-11T16:39:21.862", "create_date": "2020-03-11T16:39:21.862"}, {"id": 16808, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "097", "ranking": "03", "rank_date": "13/10/18", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "11", "score": "80", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u5deb\u986f\u6771", "head_distance": "\u9838\u4f4d", "single_win": "7.6", "actual_pound": "128", "blocking": "2 2 3", "finish_time": "1.08.72", "position_weight": "1148", "equipment": "--", "update_date": "2020-03-11T16:39:24.314", "create_date": "2020-03-11T16:39:24.314"}, {"id": 16809, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "042", "ranking": "02", "rank_date": "22/09/18", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "7", "score": "78", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u5deb\u986f\u6771", "head_distance": "\u9838\u4f4d", "single_win": "2.4", "actual_pound": "126", "blocking": "2 2 2", "finish_time": "1.08.73", "position_weight": "1145", "equipment": "--", "update_date": "2020-03-11T16:39:26.769", "create_date": "2020-03-11T16:39:26.768"}, {"id": 16810, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "027", "ranking": "02", "rank_date": "09/09/18", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "3", "score": "76", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u7530\u6cf0\u5b89", "head_distance": "3/4", "single_win": "8", "actual_pound": "133", "blocking": "3 3 2", "finish_time": "1.09.45", "position_weight": "1145", "equipment": "--", "update_date": "2020-03-11T16:39:29.225", "create_date": "2020-03-11T16:39:29.225"}, {"id": 16812, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "785", "ranking": "01", "rank_date": "08/07/18", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u6fd5\u6162", "race_class": "3", "position": "3", "score": "70", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u7530\u6cf0\u5b89", "head_distance": "3/4", "single_win": "2.9", "actual_pound": "128", "blocking": "2 2 1", "finish_time": "1.08.38", "position_weight": "1133", "equipment": "--", "update_date": "2020-03-11T16:39:31.717", "create_date": "2020-03-11T16:39:31.716"}, {"id": 16814, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "731", "ranking": "04", "rank_date": "13/06/18", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"B\"", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "3", "score": "70", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u7530\u6cf0\u5b89", "head_distance": "2-1/4", "single_win": "5.6", "actual_pound": "126", "blocking": "3 2 4", "finish_time": "1.10.24", "position_weight": "1117", "equipment": "--", "update_date": "2020-03-11T16:39:34.190", "create_date": "2020-03-11T16:39:34.189"}, {"id": 16816, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "636", "ranking": "03", "rank_date": "09/05/18", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"A\"", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "3", "score": "70", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u7530\u6cf0\u5b89", "head_distance": "1", "single_win": "4.6", "actual_pound": "127", "blocking": "3 2 3", "finish_time": "1.10.55", "position_weight": "1143", "equipment": "--", "update_date": "2020-03-11T16:39:36.648", "create_date": "2020-03-11T16:39:36.647"}, {"id": 16818, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "583", "ranking": "01", "rank_date": "18/04/18", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"B\"", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "3", "score": "63", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u7530\u6cf0\u5b89", "head_distance": "1-1/4", "single_win": "4.3", "actual_pound": "117", "blocking": "4 3 1", "finish_time": "1.09.97", "position_weight": "1125", "equipment": "--", "update_date": "2020-03-11T16:39:39.102", "create_date": "2020-03-11T16:39:39.101"}, {"id": 16820, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "562", "ranking": "02", "rank_date": "11/04/18", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"A\"", "route": "1000", "site_condition": "\u597d", "race_class": "3", "position": "11", "score": "62", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u83ab\u96f7\u62c9", "head_distance": "1-3/4", "single_win": "3.7", "actual_pound": "115", "blocking": "2 2 2", "finish_time": "0.57.31", "position_weight": "1139", "equipment": "--", "update_date": "2020-03-11T16:39:41.562", "create_date": "2020-03-11T16:39:41.562"}, {"id": 16822, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "500", "ranking": "04", "rank_date": "14/03/18", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"B\"", "route": "1000", "site_condition": "\u597d", "race_class": "3", "position": "9", "score": "62", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u53f2\u5353\u8c50", "head_distance": "3/4", "single_win": "4.7", "actual_pound": "119", "blocking": "6 7 4", "finish_time": "0.57.50", "position_weight": "1144", "equipment": "--", "update_date": "2020-03-11T16:39:44.023", "create_date": "2020-03-11T16:39:44.022"}, {"id": 16824, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "425", "ranking": "06", "rank_date": "14/02/18", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"B\"", "route": "1200", "site_condition": "\u597d", "race_class": "3", "position": "10", "score": "63", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u83ab\u96f7\u62c9", "head_distance": "4-1/4", "single_win": "5.3", "actual_pound": "116", "blocking": "1 1 6", "finish_time": "1.10.45", "position_weight": "1151", "equipment": "--", "update_date": "2020-03-11T16:39:46.480", "create_date": "2020-03-11T16:39:46.479"}, {"id": 16826, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "333", "ranking": "03", "rank_date": "10/01/18", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"B\"", "route": "1000", "site_condition": "\u597d", "race_class": "3", "position": "11", "score": "63", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u83ab\u96f7\u62c9", "head_distance": "1-1/4", "single_win": "4.2", "actual_pound": "117", "blocking": "5 5 3", "finish_time": "0.57.46", "position_weight": "1153", "equipment": "--", "update_date": "2020-03-11T16:39:48.953", "create_date": "2020-03-11T16:39:48.952"}, {"id": 16828, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "241", "ranking": "12", "rank_date": "03/12/17", "track": "\u6c99\u7530\u8349\u5730\"C+3\"", "route": "1000", "site_condition": "\u597d", "race_class": "3", "position": "10", "score": "63", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u53f2\u5353\u8c50", "head_distance": "9", "single_win": "5.8", "actual_pound": "116", "blocking": "1 2 12", "finish_time": "0.57.49", "position_weight": "1160", "equipment": "--", "update_date": "2020-03-18T13:06:47.914", "create_date": "2020-03-11T16:39:51.427"}, {"id": 18940, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "508", "ranking": "03", "rank_date": "18/03/20", "track": "\u8dd1\u99ac\u5730\u8349\u5730\"C+3\"", "route": "1200", "site_condition": "\u597d", "race_class": "2", "position": "12", "score": "90", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u5229\u656c\u570b", "head_distance": "1-1/4", "single_win": "44", "actual_pound": "123", "blocking": "11 11 3", "finish_time": "1.09.28", "position_weight": "1145", "equipment": "B", "update_date": "2020-04-17T08:43:14.849", "create_date": "2020-04-17T08:43:14.849"}, {"id": 19337, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "591", "ranking": "06", "rank_date": "19/04/20", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u597d", "race_class": "2", "position": "6", "score": "90", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u8cc0\u9298\u5e74", "head_distance": "6", "single_win": "9.6", "actual_pound": "127", "blocking": "8 7 6", "finish_time": "1.08.23", "position_weight": "1151", "equipment": "B", "update_date": "2020-04-20T22:03:58.043", "create_date": "2020-04-20T22:03:58.042"}, {"id": 21128, "name": "\u978d\u6b4c", "horse_no": "A177", "horse_id": "HK_2016_A177", "rank_id": "745", "ranking": "06", "rank_date": "14/06/20", "track": "\u6c99\u7530\u5168\u5929\u5019", "route": "1200", "site_condition": "\u6fd5\u6162", "race_class": "2", "position": "7", "score": "90", "trainer": "\u59da\u672c\u8f1d", "jockey": "\u8cc0\u9298\u5e74", "head_distance": "3", "single_win": "14", "actual_pound": "127", "blocking": "6 8 6", "finish_time": "1.08.36", "position_weight": "1145", "equipment": "B", "update_date": "2020-06-24T23:20:15.013", "create_date": "2020-06-24T23:20:15.013"}]
    keys = ['horse_no', 'horse_id', 'rank_id']
    print(Config.get_filter_dict(base, val, keys))
